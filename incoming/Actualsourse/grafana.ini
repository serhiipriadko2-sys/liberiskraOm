# Конфигурационный файл Grafana с SSL/TLS настройками
# Для экосистемы Искра

[DEFAULT]
instance_name = grafana.iskra.local

[paths]
# Путь к данным Grafana
data = /var/lib/grafana/
# Путь к логам
logs = /var/log/grafana/
# Путь к плагинам
plugins = /var/lib/grafana/plugins
# Путь к временным файлам
temp_data_lifetime = 24h

[server]
# Настройки сервера
protocol = https

# HTTPS настройки
cert_file = /etc/grafana/ssl/grafana.crt
cert_key = /etc/grafana/ssl/grafana.key

# Настройки безопасности
ssl_cert_file = /etc/grafana/ssl/grafana.crt
ssl_cert_key = /etc/grafana/ssl/grafana.key

# HTTP настройки (для редиректа на HTTPS)
http_addr = 0.0.0.0
http_port = 3000
# HTTP настройки для HTTPS
https_addr = 0.0.0.0
https_port = 3000

# Настройки SSL/TLS
ssl_min_version = TLSv1.2
ssl_cipher_suites = ECDHE-ECDSA-AES128-GCM-SHA256,ECDHE-RSA-AES128-GCM-SHA256,ECDHE-ECDSA-AES256-GCM-SHA384,ECDHE-RSA-AES256-GCM-SHA384,ECDHE-ECDSA-CHACHA20-POLY1305,ECDHE-RSA-CHACHA20-POLY1305,DHE-RSA-AES128-GCM-SHA256,DHE-RSA-AES256-GCM-SHA384
ssl_prefer_server_ciphers = true

# Принудительный HTTPS (редирект с HTTP на HTTPS)
force_ssl = true

# Настройки домена
domain = grafana.iskra.local
root_url = https://grafana.iskra.local:3000/
serve_from_sub_path = false

# Настройки куки для безопасности
cookie_secure = true
cookie_samesite = strict
allow_embedding = false

[security]
# Настройки безопасности
admin_user = admin
admin_password = IskraSecure2024!

# Секретный ключ для подписи сессий
secret_key = IskraEcosystem2024SecretKeyForGrafana

# Настройки пользователей
disable_gravatar = false
data_source_proxy_whitelist = 
cookie_secure = true
cookie_samesite = strict
allow_embedding = false

# Настройки SSL для встроенного веб-сервера
ssl_cert_file = /etc/grafana/ssl/grafana.crt
ssl_cert_key = /etc/grafana/ssl/grafana.key
ssl_min_version = TLSv1.2
ssl_cipher_suites = ECDHE-ECDSA-AES128-GCM-SHA256,ECDHE-RSA-AES128-GCM-SHA256,ECDHE-ECDSA-AES256-GCM-SHA384,ECDHE-RSA-AES256-GCM-SHA384,ECDHE-ECDSA-CHACHA20-POLY1305,ECDHE-RSA-CHACHA20-POLY1305,DHE-RSA-AES128-GCM-SHA256,DHE-RSA-AES256-GCM-SHA384
ssl_prefer_server_ciphers = true

# Дополнительные настройки безопасности
disable_brute_force_login_protection = false
brute_force_login_protection = true

[users]
# Настройки пользователей
allow_sign_up = false
allow_org_create = false
auto_assign_org = true
auto_assign_org_id = 1
auto_assign_org_role = Viewer
verify_email_enabled = false
login_hint = email or username
password_hint = password
default_theme = dark

[auth]
# Настройки аутентификации
login_cookie_name = grafana_session
login_maximum_inactive_lifetime_duration = 
login_maximum_lifetime_duration = 
token_rotation_interval_minutes = 10
disable_login_form = false
disable_signout_menu = false
signout_redirect_url = 
oauth_auto_login = false
oauth_state_cookie_max_age = 60

[auth.anonymous]
# Настройки анонимного доступа
enabled = false
org_role = Viewer
hide_version = false

[auth.ldap]
# Настройки LDAP аутентификации
enabled = false
config_file = /etc/grafana/ldap.toml
allow_sign_up = true

[smtp]
# Настройки SMTP для уведомлений
enabled = false
host = 
user = 
password = 
cert_file = 
key_file = 
skip_verify = false
from_address = admin@grafana.local
from_name = Grafana
ehlo_identity = 
startTLS_policy = 

[emails]
# Настройки email
welcome_email_on_sign_up = false
templates_pattern = emails/*.html

[log]
# Настройки логирования
mode = console file
level = info
format = text
targets = console,file

# Консольные логи
console = 
console_level = 

# Файловые логи
file = /var/log/grafana/grafana.log
file_level = info
log_rotate = true
max_lines = 1000000
max_size_shift = 28
daily_rotate = true
max_days = 7

[log.file]
# Дополнительные настройки файловых логов
path = /var/log/grafana/grafana.log
max_lines = 1000000
max_size_shift = 28
daily_rotate = true
max_days = 7

[log.syslog]
# Настройки syslog
enabled = false
network = 
address = 
facility = 
tag = 

[metrics]
# Настройки метрик
enabled = true
interval_seconds = 10
disable_total_stats = false

[metrics.graphite]
# Настройки Graphite метрик
address = 
prefix = grafana

[tracing.jaeger]
# Настройки Jaeger tracing
enabled = false
address = 

[external_image_storage]
# Настройки внешнего хранилища изображений
provider = 

[external_image_storage.s3]
# Настройки S3 хранилища
endpoint = 
path_style_access = 
bucket = 
region = 
path = 
bucket_url = 
sig_version = 
remove_deleted_files = false

[external_image_storage.webdav]
# Настройки WebDAV хранилища
url = 
username = 
password = 
bearer_token = 

[external_image_storage.gcs]
# Настройки Google Cloud Storage
key_file = 
bucket = 
path = 

[external_image_storage.azure_blob]
# Настройки Azure Blob Storage
account_name = 
account_key = 
container_name = 
blob_version = 

[external_image_storage.local]
# Настройки локального хранилища

[alerting]
# Настройки алертинга
enabled = true
execute_alerts = true
error_or_timeout = alerting
nodata_or_nullvalues = no_data
concurrent_render_limit = 5
max_attempts = 3
min_re_interval = 30s

# Дисконнект алертинга
disabled_orgs = 
admin_config_poll_interval = 60s
alertmanager_config_poll_interval = 60s

[dashboards]
# Настройки дашбордов
default_home_dashboard_path = 

[alerting.embedded_images]
# Настройки встроенных изображений в алертах
enabled = true

[alerting.additional_metrics_matrix]
# Дополнительная матрица метрик для алертов
enabled = false

[datasources]
# Настройки источников данных
disable_metrics_format = false
disable_sessions = false

[unified_alerting.datasources]
# Настройки источников данных для нового алертинга
enabled = true
data_sync_period = 10m
delta_scan_period = 1m

[unified_alerting]
# Настройки нового алертинга
enabled = true
disabled_orgs = 
admin_config_poll_interval = 60s
alertmanager_config_poll_interval = 60s
max_attempts = 3
min_re_interval = 30s
execute_alerts = true
error_or_timeout = alerting
nodata_or_nullvalues = no_data
concurrent_render_limit = 5

[unified_alerting.screenshots]
# Настройки скриншотов в алертах
enabled = true
max_concurrent_screenshots = 5
capture_timeout = 10s
upload_external_image_storage = false

[unified_alerting.reserved_labels]
# Зарезервированные метки для алертинга
label_list = 
keep_fixing = false

[feature_toggles]
# Функциональные переключатели
enable = 

[feature_toggles.packages]
# Переключатели пакетов (Enterprise)
enable = 

[reporting]
# Настройки отчетов
enabled = false
rendering_server_url = 
rendering_callback_url = 
max_parallel_snapshots = 5
scale_factor = 2

[enterprise]
# Настройки Enterprise
license_path = 

[explore]
# Настройки Explore
enabled = true

[help]
# Настройки Help
enabled = true

[profile]
# Настройки профиля пользователя
enabled = true

[news]
# Настройки новостей
enabled = true

[query_history]
# Настройки истории запросов
enabled = true

[core]
# Основные настройки
minimal_panel_size = 10x10