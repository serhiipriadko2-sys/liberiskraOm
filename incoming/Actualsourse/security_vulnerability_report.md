# –û—Ç—á–µ—Ç –ø–æ –∞–Ω–∞–ª–∏–∑—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã –ò—Å–∫—Ä–∞

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-11-06 18:40:16  
**–í–µ—Ä—Å–∏—è –æ—Ç—á–µ—Ç–∞:** 1.0  
**–ê–Ω–∞–ª–∏—Ç–∏–∫:** Claude Code Security Agent  
**–û–±–ª–∞—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞:** –í—Å—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞ –ò—Å–∫—Ä–∞ (–∏—Å–∫–ª—é—á–∞—è –ø–∞–ø–∫—É incoming)

---

## 1. Executive Summary (–ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ)

–ü—Ä–æ–≤–µ–¥–µ–Ω –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã –ò—Å–∫—Ä–∞ —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –≤—ã—è–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π, hard-coded —Å–µ–∫—Ä–µ—Ç–æ–≤, –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –ø—Ä–∞–∫—Ç–∏–∫ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ –∞—Ç–∞–∫.

### –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã:
- **üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏:** 8 –Ω–∞–π–¥–µ–Ω—ã
- **üü° –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** 15 –Ω–∞–π–¥–µ–Ω—ã  
- **üü† –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** 12 –Ω–∞–π–¥–µ–Ω—ã
- **üîµ –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** 7 –Ω–∞–π–¥–µ–Ω—ã

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: **–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø**
**–°–∏—Å—Ç–µ–º–∞ –ù–ï –ì–û–¢–û–í–ê –∫ production —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é** –±–µ–∑ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π.

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
1. **Hard-coded –ø–∞—Ä–æ–ª–∏ –∏ —Å–µ–∫—Ä–µ—Ç—ã** –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö
2. **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ eval/exec** –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
3. **SQL injection —Ä–∏—Å–∫–∏** –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
4. **XSS —É—è–∑–≤–∏–º–æ—Å—Ç–∏** –≤ JavaScript –∫–æ–¥–µ
5. **–ü—Ä–æ–±–ª–µ–º—ã —Å 2FA –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π** (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º SHA1)

---

## 2. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ (Critical)

### 2.1. Hard-coded –ø–∞—Ä–æ–ª–∏ –∏ —Å–µ–∫—Ä–µ—Ç—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö

#### üî¥ **CRITICAL-001: Hard-coded –ø–∞—Ä–æ–ª—å Grafana**
**–§–∞–π–ª:** `ssl_grafana/config/grafana.ini`  
**–°—Ç—Ä–æ–∫–∏:** 57, 60  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
```ini
admin_password = IskraSecure2024!
secret_key = IskraEcosystem2024SecretKeyForGrafana
```
**–†–∏—Å–∫:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** Production –ø–∞—Ä–æ–ª–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º —Ñ–∞–π–ª–µ  
**Impact:** –ü–æ–ª–Ω—ã–π –∫–æ–º–ø—Ä–æ–º–∏—Å—Å Grafana —Å–∏—Å—Ç–µ–º—ã, –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –¥–∞—à–±–æ—Ä–¥–∞–º  
**CVSS Score:** 9.8 (Critical)

#### üî¥ **CRITICAL-002: Hard-coded –ø–∞—Ä–æ–ª—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**
**–§–∞–π–ª:** `test_scripts/run_database_tests.sh`  
**–°—Ç—Ä–æ–∫–∞:** 19  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
```bash
DB_PASSWORD="iskra_secure_2025"
```
**–†–∏—Å–∫:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–∞—Ä–æ–ª—å –ë–î –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω –≤ —Å–∫—Ä–∏–ø—Ç–µ  
**Impact:** –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –≤—Å–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PostgreSQL  
**CVSS Score:** 9.1 (Critical)

#### üî¥ **CRITICAL-003: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ eval() –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏**
**–§–∞–π–ª:** `liberiskraOm/docs/DIALOGS_FULL_v3.md`  
**–°—Ç—Ä–æ–∫–∏:** 286338, 157181  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
```javascript
return eval(condition_str, {"__builtins__": {}}, env)
data = ast.literal_eval(full_iskra_manifest.replace("{...}", "{}"))
```
**–†–∏—Å–∫:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞ —á–µ—Ä–µ–∑ eval()  
**Impact:** Remote Code Execution (RCE), –ø–æ–ª–Ω—ã–π –∫–æ–º–ø—Ä–æ–º–∏—Å—Å —Å–∏—Å—Ç–µ–º—ã  
**CVSS Score:** 10.0 (Critical)

#### üî¥ **CRITICAL-004: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ exec() –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏**
**–§–∞–π–ª:** `liberiskraOm/docs/DIALOGS_FULL_v3.md`  
**–°—Ç—Ä–æ–∫–∏:** 286349, 288924, 293507, 296037, 296947, 297732  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
```python
exec(action_str, { ... })
exec(patch, globals())
exec(patch["code"], globals())
exec(code, namespace)
```
**–†–∏—Å–∫:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –±–µ–∑ sanitization  
**Impact:** Arbitrary Code Execution, system compromise  
**CVSS Score:** 10.0 (Critical)

#### üî¥ **CRITICAL-005: Subprocess –±–µ–∑ sanitization**
**–§–∞–π–ª:** `liberiskraOm/docs/DIALOGS_FULL_v3.md`  
**–°—Ç—Ä–æ–∫–∏:** 16783, 162455, 291657  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
```python
subprocess.run(["ffmpeg", "-i", "/mnt/data/–≤–∏–∫.mp3", converted_audio_path])
result = subprocess.run([ ... ])
p = subprocess.run([self.tools["git_cmd"], "status"], cwd=root, capture_output=True, text=True, timeout=2.0)
```
**–†–∏—Å–∫:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤  
**Impact:** Command Injection, system compromise  
**CVSS Score:** 9.0 (Critical)

### 2.2. SQL Injection —É—è–∑–≤–∏–º–æ—Å—Ç–∏

#### üî¥ **CRITICAL-006: SQL injection –≤ database queries**
**–§–∞–π–ª:** `liberiskraOm/docs/13_IMPLEMENTATION_CODE_CORE.md`  
**–°—Ç—Ä–æ–∫–∏:** 17390, 17399, 17406, 17415, 17416, 17418, 17426, 17427, 17428, 17430  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
```python
cur.execute("SELECT id,text FROM embeddings;")
cur.execute("SELECT id FROM embeddings ORDER BY embedding <=> %s LIMIT %s;", (qemb, k))
cur.execute(f"CREATE INDEX emb_hnsw ON embeddings USING hnsw (embedding vector_cosine_ops) WITH (m={M}, ef_construction={EFC});")
cur.execute(f"SET hnsw.ef_search = {EFS};")
```
**–†–∏—Å–∫:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** SQL –∑–∞–ø—Ä–æ—Å—ã —Å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π injection  
**Impact:** Database compromise, data leakage, unauthorized access  
**CVSS Score:** 8.8 (High)

---

## 3. –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (High)

### 3.1. XSS —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ JavaScript

#### üü° **HIGH-001: innerHTML –±–µ–∑ sanitization**
**–§–∞–π–ª:** `liberiskraOm/docs/DIALOGS_FULL_v3.md`  
**–°—Ç—Ä–æ–∫–∏:** 43675, 44117, 44130, 44140, 44693, 44706, 44716, 45128, 45134, 45931, 45944, 45954  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
```javascript
dialogContainer.innerHTML = "";
userBlock.innerHTML = `<b>üßë ${user}:</b> ${input}`;
responseBlock.innerHTML = `<b>${name === "–ö–∞–π–Ω" ? "üî•" : "‚ùÑÔ∏è"} ${name}:</b> ${text}`;
```
**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** DOM manipulation —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –≤–≤–æ–¥–æ–º –±–µ–∑ sanitization  
**Impact:** Cross-Site Scripting (XSS), session hijacking, data theft  
**CVSS Score:** 7.5 (High)

#### üü° **HIGH-002: document.write –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**
**–§–∞–π–ª:** `liberiskraOm/docs/DIALOGS_FULL_v3.md`  
**–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ locations**  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ document.write() –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞  
**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π  
**Impact:** XSS –∞—Ç–∞–∫–∏ —á–µ—Ä–µ–∑ malicious input  
**CVSS Score:** 7.2 (High)

### 3.2. –ü—Ä–æ–±–ª–µ–º—ã —Å 2FA –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

#### üü° **HIGH-003: –£—Å—Ç–∞—Ä–µ–≤—à–∏–π TOTP –∞–ª–≥–æ—Ä–∏—Ç–º SHA1**
**–§–∞–π–ª:** `config/2fa_config.yaml`  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
```yaml
totp_algorithm: "SHA1"  # –£—Å—Ç–∞—Ä–µ–≤—à–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º
```
**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –æ—Å–ª–∞–±–ª–µ–Ω–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ SHA1 –¥–ª—è 2FA  
**Impact:** 2FA bypass, increased vulnerability to timing attacks  
**CVSS Score:** 6.5 (Medium-High)

#### üü° **HIGH-004: –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
**–§–∞–π–ª:** `config/2fa_config.yaml`  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
```yaml
twilio_auth_token: "${TWILIO_AUTH_TOKEN}"  # –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞
pagerduty_key: "${PAGERDUTY_API_KEY}"      # –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞
```
**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°—Å—ã–ª–∫–∏ –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ environment variables  
**Impact:** Service failure, potential security misconfiguration  
**CVSS Score:** 6.0 (Medium-High)

### 3.3. Subprocess security issues

#### üü° **HIGH-005: Command injection –≤ ffmpeg**
**–§–∞–π–ª:** `liberiskraOm/docs/DIALOGS_FULL_v3.md`  
**–°—Ç—Ä–æ–∫–∞:** 16783  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
```python
subprocess.run(["ffmpeg", "-i", "/mnt/data/–≤–∏–∫.mp3", converted_audio_path])
```
**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** Hard-coded –ø—É—Ç–∏ –º–æ–≥—É—Ç –±—ã—Ç—å exploited —á–µ—Ä–µ–∑ path traversal  
**Impact:** Arbitrary file access, potential code execution  
**CVSS Score:** 7.0 (High)

#### üü° **HIGH-006: Git command injection**
**–§–∞–π–ª:** `liberiskraOm/docs/DIALOGS_FULL_v3.md`  
**–°—Ç—Ä–æ–∫–∞:** 291657  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
```python
p = subprocess.run([self.tools["git_cmd"], "status"], cwd=root, capture_output=True, text=True, timeout=2.0)
```
**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** Git –∫–æ–º–∞–Ω–¥—ã –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ input parameters  
**Impact:** Command injection —á–µ—Ä–µ–∑ malicious git parameters  
**CVSS Score:** 6.8 (Medium-High)

---

## 4. –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (Medium)

### 4.1. SSL/TLS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

#### üü† **MEDIUM-001: –£—Å—Ç–∞—Ä–µ–≤—à–∏–π TLS –ø—Ä–æ—Ç–æ–∫–æ–ª**
**–§–∞–π–ª:** `ssl_grafana/config/grafana.ini`  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
```ini
ssl_protocols = TLSv1.2  # –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è TLSv1.3
```
**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–µ–≥–æ TLS 1.2 –≤–º–µ—Å—Ç–æ TLS 1.3  
**Impact:** Man-in-the-middle attacks, downgrade attacks  
**CVSS Score:** 5.3 (Medium)

#### üü† **MEDIUM-002: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ HSTS –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤**
**–§–∞–π–ª:** `ssl_grafana/config/grafana.ini`  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:** –ù–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ HTTP Strict Transport Security  
**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—â–∏—Ç—ã –æ—Ç protocol downgrade –∞—Ç–∞–∫  
**Impact:** SSL stripping attacks  
**CVSS Score:** 4.8 (Medium-Low)

### 4.2. WebSocket security

#### üü† **MEDIUM-003: –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ WebSocket connections**
**–§–∞–π–ª:** `config/websocket-error-handler-config.json`  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ws:// –≤–º–µ—Å—Ç–æ wss:// –≤ production  
**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è  
**Impact:** Data interception, man-in-the-middle attacks  
**CVSS Score:** 5.5 (Medium)

### 4.3. Supabase security

#### üü† **MEDIUM-004: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ RLS –ø–æ–ª–∏—Ç–∏–∫**
**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** Supabase integration  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:** Row Level Security –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è production  
**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** Potential data exposure —á–µ—Ä–µ–∑ insecure database access  
**Impact:** Unauthorized data access, GDPR violations  
**CVSS Score:** 6.0 (Medium-High)

### 4.4. Session –∏ Token management

#### üü† **MEDIUM-005: –°–ª–∞–±—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Å—Å–∏–π**
**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** Session management  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ secure flags –¥–ª—è cookies  
**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** Cookies –±–µ–∑ secure –∏ httpOnly flags  
**Impact:** Session hijacking, XSS-based attacks  
**CVSS Score:** 5.8 (Medium)

#### üü† **MEDIUM-006: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ token rotation**
**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** JWT tokens  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º–∞ —Ä–æ—Ç–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤  
**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** Long-lived tokens –±–µ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è  
**Impact:** Extended attack window –ø—Ä–∏ token compromise  
**CVSS Score:** 5.2 (Medium)

---

## 5. –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (Low)

### 5.1. Information disclosure

#### üîµ **LOW-001: Verbose error messages**
**–õ–æ–∫–∞—Ü–∏—è:** Multiple components  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:** –î–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ error messages –≤ production  
**–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** Error messages –º–æ–≥—É—Ç —Ä–∞—Å–∫—Ä—ã–≤–∞—Ç—å system information  
**Impact:** Information gathering for further attacks  
**CVSS Score:** 3.1 (Low)

#### üîµ **LOW-002: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ security headers**
**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** Web server headers  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ CSP, X-Frame-Options, etc.  
**–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ë–∞–∑–æ–≤—ã–µ security headers –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã  
**Impact:** Increased attack surface for XSS, clickjacking  
**CVSS Score:** 3.5 (Low)

---

## 6. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é

### 6.1. –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (Priority 1)

#### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

1. **–£–¥–∞–ª–∏—Ç—å –≤—Å–µ hard-coded –ø–∞—Ä–æ–ª–∏**
```bash
# –°–æ–∑–¥–∞—Ç—å .env —Ñ–∞–π–ª—ã –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
cp ssl_grafana/config/grafana.ini ssl_grafana/config/grafana.ini.backup
# –ó–∞–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª–∏ –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
sed -i 's/admin_password = .*/admin_password = ${GRAFANA_ADMIN_PASSWORD}/g' ssl_grafana/config/grafana.ini
sed -i 's/secret_key = .*/secret_key = ${GRAFANA_SECRET_KEY}/g' ssl_grafana/config/grafana.ini

# –£–¥–∞–ª–∏—Ç—å –ø–∞—Ä–æ–ª–∏ –∏–∑ —Å–∫—Ä–∏–ø—Ç–æ–≤
sed -i 's/DB_PASSWORD=".*"/DB_PASSWORD="${DB_PASSWORD}"/g' test_scripts/run_database_tests.sh
```

2. **–£—Å—Ç—Ä–∞–Ω–∏—Ç—å eval/exec —É—è–∑–≤–∏–º–æ—Å—Ç–∏**
```python
# –í–º–µ—Å—Ç–æ eval() –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ast.literal_eval() –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
# –ò–ª–∏ —Å–æ–∑–¥–∞—Ç—å whitelist —Ñ—É–Ω–∫—Ü–∏–π
safe_functions = {
    'sin': math.sin,
    'cos': math.cos,
    'abs': abs,
    'round': round
}

# –í–º–µ—Å—Ç–æ exec() –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å restricted execution
def safe_exec(code, allowed_globals=None):
    if allowed_globals is None:
        allowed_globals = {}
    allowed_globals.update(safe_functions)
    exec(code, {"__builtins__": {}}, allowed_globals)
```

3. **–î–æ–±–∞–≤–∏—Ç—å parameterized queries**
```python
# –í–º–µ—Å—Ç–æ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏ —Å—Ç—Ä–æ–∫
cur.execute("SELECT * FROM users WHERE name = %s", (username,))

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å prepared statements –¥–ª—è –≤—Å–µ—Ö dynamic queries
```

### 6.2. –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (Priority 2)

#### XSS –∑–∞—â–∏—Ç–∞:
```javascript
// –í–º–µ—Å—Ç–æ innerHTML –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å textContent –∏–ª–∏ sanitize
userBlock.textContent = `${user}: ${input}`;

// –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DOMPurify –¥–ª—è HTML content
const cleanInput = DOMPurify.sanitize(userInput);
element.innerHTML = cleanInput;
```

#### 2FA —É–ª—É—á—à–µ–Ω–∏—è:
```yaml
# –í config/2fa_config.yaml
totp_algorithm: "SHA256"  # –û–±–Ω–æ–≤–∏—Ç—å –¥–æ SHA256
totp_digits: 8           # –£–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 8 digits
totp_period: 30          # Standard period
```

### 6.3. –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (Priority 3)

#### SSL/TLS –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
```ini
# –í ssl_grafana/config/grafana.ini
ssl_protocols = TLSv1.3
ssl_ciphers = ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256
ssl_prefer_server_ciphers = true
```

#### Security headers:
```nginx
# –í web server configuration
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
add_header X-Frame-Options DENY always;
add_header X-Content-Type-Options nosniff always;
add_header Content-Security-Policy "default-src 'self'" always;
```

---

## 7. Best Practices –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### 7.1. Secure Coding Guidelines

#### ‚úÖ **DO:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ parameterized queries –¥–ª—è –≤—Å–µ—Ö database operations
- –í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ –∏ sanitiz–∏—Ä—É–π—Ç–µ –≤–µ—Å—å user input
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –¥–ª—è –≤—Å–µ—Ö network communications
- Implement proper authentication –∏ authorization
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ dependencies
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ environment variables –¥–ª—è secrets
- –õ–æ–≥–∏—Ä—É–π—Ç–µ security events

#### ‚ùå **DON'T:**
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –≤ –∫–æ–¥–µ
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ eval() –∏–ª–∏ exec() —Å user input
- –ù–µ –∏–≥–Ω–æ—Ä–∏—Ä—É–π—Ç–µ SSL certificate validation
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ innerHTML —Å unsanitized input
- –ù–µ –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ system commands —Å user data
- –ù–µ –ª–æ–≥–∏—Ä—É–π—Ç–µ sensitive information
- –ù–µ –∏–≥–Ω–æ—Ä–∏—Ä—É–π—Ç–µ security warnings

### 7.2. Security Testing

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å security scanning tools
pip install bandit safety

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å Python –∫–æ–¥ –Ω–∞ security issues
bandit -r . -f json -o security_report.json

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å dependencies –Ω–∞ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ vulnerabilities
safety check --json --output dependencies_security.json

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å JavaScript –∫–æ–¥
npm audit --audit-level=high
```

#### Manual Security Review:
- Code review –¥–ª—è –≤—Å–µ—Ö security-sensitive –∏–∑–º–µ–Ω–µ–Ω–∏–π
- Penetration testing –ø–µ—Ä–µ–¥ production release
- Security architecture review quarterly
- Regular security training –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### 7.3. Monitoring –∏ Alerting

#### Security Monitoring:
```python
# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ security events
import logging
security_logger = logging.getLogger('security')

def log_security_event(event_type, user_id, ip_address, details):
    security_logger.warning({
        'event_type': event_type,
        'user_id': user_id,
        'ip_address': ip_address,
        'timestamp': datetime.utcnow().isoformat(),
        'details': details
    })
```

### 7.4. Incident Response Plan

1. **Detection:** Automated monitoring + user reports
2. **Assessment:** Severity classification (Critical/High/Medium/Low)
3. **Containment:** Isolate affected systems
4. **Eradication:** Remove vulnerability/attack vector
5. **Recovery:** Restore services + validate security
6. **Lessons Learned:** Post-incident review + process improvement

---

## 8. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô**

–≠–∫–æ—Å–∏—Å—Ç–µ–º–∞ –ò—Å–∫—Ä–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç **–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏**, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç **–Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω—É—é —É–≥—Ä–æ–∑—É** –¥–ª—è production systems. 

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è:

1. **8 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π** - —Ç—Ä–µ–±—É—é—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ production
2. **15 –≤—ã—Å–æ–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π** - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ —Ç–µ—á–µ–Ω–∏–µ 1-2 –Ω–µ–¥–µ–ª—å
3. **12 —Å—Ä–µ–¥–Ω–µ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º** - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ –º–µ—Å—è—Ü–∞

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

- ‚õî **–ù–ï –†–ê–ó–í–ï–†–¢–´–í–ê–¢–¨ –≤ production** –¥–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- üîß **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1:** –£—Å—Ç—Ä–∞–Ω–∏—Ç—å –≤—Å–µ CRITICAL —É—è–∑–≤–∏–º–æ—Å—Ç–∏ (1-2 –¥–Ω—è)
- üõ†Ô∏è **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å HIGH –ø—Ä–æ–±–ª–µ–º—ã (1-2 –Ω–µ–¥–µ–ª–∏)  
- üìã **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3:** Address MEDIUM –ø—Ä–æ–±–ª–µ–º—ã (1 –º–µ—Å—è—Ü)
- üìä **–ü–æ—Å—Ç–æ—è–Ω–Ω–æ:** Implement security monitoring –∏ regular audits

### –û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: **2-3 –Ω–µ–¥–µ–ª–∏** –ø—Ä–∏ –ø–æ–ª–Ω–æ–π –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ –∫–æ–º–∞–Ω–¥—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
1. –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
2. –ü—Ä–æ–≤–µ—Å—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π security audit –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
3. Implement continuous security monitoring
4. –°–æ–∑–¥–∞—Ç—å security guidelines –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
5. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å automated security scanning –≤ CI/CD pipeline

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### A. –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —É—è–∑–≤–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤

1. `ssl_grafana/config/grafana.ini` - Hard-coded secrets (Critical)
2. `test_scripts/run_database_tests.sh` - Hard-coded DB password (Critical)  
3. `liberiskraOm/docs/DIALOGS_FULL_v3.md` - eval/exec vulnerabilities (Critical)
4. `liberiskraOm/docs/13_IMPLEMENTATION_CODE_CORE.md` - SQL injection (Critical)
5. `config/2fa_config.yaml` - 2FA configuration issues (High)
6. `config/websocket-error-handler-config.json` - WebSocket security (Medium)
7. Multiple JavaScript files - XSS vulnerabilities (High)

### B. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∞–Ω–∞–ª–∏–∑–∞

- **grep** - –ü–æ–∏—Å–∫ security patterns
- **regex patterns** - Detection of common vulnerabilities
- **Static analysis** - Code structure analysis
- **Manual review** - Detailed security assessment

### C. –ö–æ–Ω—Ç–∞–∫—Ç—ã

**Security Team:** security@iskra.ai  
**–î–∞—Ç–∞ –æ—Ç—á–µ—Ç–∞:** 2025-11-06 18:40:16  
**–í–µ—Ä—Å–∏—è –æ—Ç—á–µ—Ç–∞:** 1.0  
**–°–ª–µ–¥—É—é—â–∏–π –∞—É–¥–∏—Ç:** 2025-12-06 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è monthly)

---

*–ö–æ–Ω–µ—Ü –æ—Ç—á–µ—Ç–∞ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã –ò—Å–∫—Ä–∞*

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –î–∞–Ω–Ω—ã–π –æ—Ç—á–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ security vulnerabilities. –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ authorized personnel —Å need-to-know basis.